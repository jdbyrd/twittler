<!DOCTYPE html>
<html>
  <head>
    <meta charset = "utf-8">
    <link rel="stylesheet" href="main.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    
    <header class = "container">
      <h1>Twittler</h1>
    </header>

    <div class = "UserFeed container">
      <h3 class = "UserHeader"></h3>
      <p class = "UserButton">Click Here To Go Back To Home Feed</p>
    </div>


    <script>


      $(document).ready(function(){
        var $body = $('body');
        var $userFeed = $('.UserFeed');
        var $userHeader = $('.UserHeader');
        $userFeed.hide();
        var index = streams.home.length - 1;
        var counter = 0;
        var $section = $('<section></section');
        $section.appendTo('body');
        $section.addClass('tweeter container');

        newTwit();
        var tweetInterval = setInterval(newTwit, 3000);


        function newTwit(){
          for(x = counter; counter < streams.home.length; counter++){
            var tweet = streams.home[counter];
            var userName = tweet.user;
            var $tweet = $('<div></div>');
            var $tweetName = $('<h4></h4>');
            $tweet.addClass('Tweet');
            $tweetName.addClass('TweetName');
            var $tweetMsg = $('<p></p>');
            $tweetName.data({'user': userName});
            $tweetName.text('@' + tweet.user);
            $tweetMsg.text(': ' + tweet.message + ' ' + tweet.created_at);
            $tweet.prependTo($section);
            $tweetName.appendTo($tweet);
            $tweetMsg.appendTo($tweet);
            $('.TweetName').on('click', showUser);

          }
        }

        function showUser(){
          var userCounter = 0;
          var user = $(this).data('user');
          $('section.tweeter').remove()
          var $newSection = $('<section></section');
          $newSection.appendTo('body');
          $newSection.addClass('user container');
          newUserTwit();
          var userInterval = setInterval(newUserTwit, 3000);
          $userHeader.text('@' + user + '\'s feed');
          $userFeed.show();
          $('.UserButton').on('click', goBackToHome);

          function newUserTwit(){
            for(x = userCounter; userCounter < streams.users[user].length; userCounter++){
              var userTweet = streams.users[user][userCounter];
              var $userTweet = $('<div></div>');
              var $userTweetName = $('<h4></h4>');
              var $userTweetMsg = $('<p></p>');
              $userTweet.addClass('Tweet');
              $userTweetName.text('@' + user);
              $userTweetMsg.text(': ' + userTweet.message + ' ' + userTweet.created_at);
              $userTweet.prependTo($newSection);
              $userTweetName.appendTo($userTweet);
              $userTweetMsg.appendTo($userTweet);
            }
          }
        }

        function goBackToHome(){
          $('section.user').remove();
          userCounter = 0;
          $userFeed.hide();
          $section.appendTo('body');
          newTwit();
        }

      });

    </script>

  </body>
</html>
